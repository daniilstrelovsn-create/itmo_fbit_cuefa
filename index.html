<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BEAT FBIT - –ö–∏–±–µ—Ä–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #0d1117;
            color: #c9d1d9;
            margin: 0;
            padding: 20px;
            display: flex;
            gap: 40px;
            position: relative;
            overflow-x: hidden;
        }
        
        .game-area {
            flex: 1;
            background: #161b22;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #30363d;
        }
        
        .code-area {
            flex: 1;
            background: #161b22;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #30363d;
        }
        
        .choices {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }
        
        .choice {
            width: 100px;
            height: 100px;
            border: 2px solid #30363d;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #0d1117;
        }
        
        .choice:hover {
            border-color: #58a6ff;
            transform: scale(1.05);
        }
        
        .choice.selected {
            border-color: #ffd33d;
            background: #1c2128;
        }
        
        .choice-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }
        
        button {
            background: #238636;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 20px 0;
        }
        
        button:hover {
            background: #2ea043;
        }
        
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 6px;
            background: #1c2128;
            min-height: 60px;
        }
        
        .code-block {
            background: #0d1117;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #30363d;
            margin: 15px 0;
            font-family: monospace;
            line-height: 1.6;
        }
        
        .draggable {
            background: #58a6ff;
            color: #0d1117;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: move;
            display: inline-block;
            margin: 2px;
            font-weight: bold;
        }
        
        .slot {
            display: inline-block;
            min-width: 60px;
            height: 24px;
            border: 2px dashed #30363d;
            border-radius: 4px;
            margin: 0 5px;
            vertical-align: middle;
            text-align: center;
            line-height: 20px;
            position: relative;
        }
        
        .slot.empty::before {
            content: "‚àÖ";
            color: #8b949e;
            font-size: 14px;
        }
        
        .slot.hover {
            border-color: #58a6ff;
            background: #1c2128;
        }
        
        .slot-content {
            background: #58a6ff;
            color: #0d1117;
            padding: 2px 6px;
            border-radius: 3px;
            cursor: move;
        }
        
        .result-slot {
            display: inline-block;
            padding: 2px 8px;
            margin: 0 5px;
            border-radius: 4px;
        }
        
        .win { color: #3fb950; }
        .lose { color: #f85149; }
        .draw { color: #ffd33d; }
        
        .sequence {
            font-family: monospace;
            background: #000;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            word-break: break-all;
        }
        
        .rule-item {
            margin: 10px 0;
            padding: 10px;
            background: #1c2128;
            border-radius: 6px;
        }
        
        .draggables-panel {
            background: #0d1117;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
            border: 1px solid #30363d;
        }
        
        .delete-zone {
            background: #f85149;
            color: white;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            margin: 10px 0;
            border: 2px dashed #ff6b6b;
            transition: all 0.3s;
        }
        
        .delete-zone.hover {
            background: #ff6b6b;
            transform: scale(1.02);
        }
        
        .empty-slot {
            color: #8b949e;
            font-style: italic;
        }
        
        .win-counter {
            background: #1c2128;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            text-align: center;
            border: 1px solid #30363d;
        }
        
        .win-streak {
            font-size: 18px;
            font-weight: bold;
            color: #ffd33d;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Å–∞–ª—é—Ç–∞ */
        .firework {
            position: fixed;
            pointer-events: none;
            z-index: 1000;
        }
        
        .particle {
            position: absolute;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            animation: explode 1.5s ease-out forwards;
        }
        
        @keyframes explode {
            0% {
                transform: translate(0, 0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty)) scale(0);
                opacity: 0;
            }
        }
        
        .sequence-info {
            background: #1c2128;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            border: 1px solid #30363d;
        }
        
        .refresh-btn {
            background: #58a6ff;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .refresh-btn:hover {
            background: #6ab0ff;
        }
    </style>
</head>
<body>
    <div class="game-area">
        <h1>üéÆ BEAT FBIT</h1>
        
        <div class="win-counter">
            <div>–°—á—ë—Ç—á–∏–∫ –ø–æ–±–µ–¥ –ø–æ–¥—Ä—è–¥:</div>
            <div class="win-streak" id="winStreak">0</div>
        </div>
        
        <div class="choices">
            <div class="choice" data-value="100">
                <div class="choice-icon">üïµÔ∏è</div>
                <div>–í–∑–ª–æ–º—â–∏–∫</div>
                <small></small>
            </div>
            <div class="choice" data-value="01">
                <div class="choice-icon">üõ°Ô∏è</div>
                <div>–ó–∞—â–∏—Ç–∞</div>
                <small></small>
            </div>
            <div class="choice" data-value="1100">
                <div class="choice-icon">üíä</div>
                <div>–£—è–∑–≤–∏–º–æ—Å—Ç—å</div>
                <small></small>
            </div>
        </div>
        
        <button id="playButton">üéØ –ò–≥—Ä–∞—Ç—å</button>
        
        <div class="result" id="result">
            –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ "–ò–≥—Ä–∞—Ç—å"
        </div>
        
        <div class="rules">
            <h3>–ü—Ä–∞–≤–∏–ª–∞:</h3>
            <ul>
                <li><strong>–í–∑–ª–æ–º—â–∏–∫ > –£—è–∑–≤–∏–º–æ—Å—Ç—å</strong>: –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç—å</li>
                <li><strong>–ó–∞—â–∏—Ç–∞ > –í–∑–ª–æ–º—â–∏–∫</strong>: –°–∏—Å—Ç–µ–º–∞ –∑–∞—â–∏—Ç—ã –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞—Ç–∞–∫—É</li>
                <li><strong>–£—è–∑–≤–∏–º–æ—Å—Ç—å > –ó–∞—â–∏—Ç–∞</strong>: –£—è–∑–≤–∏–º–æ—Å—Ç—å –æ–±—Ö–æ–¥–∏—Ç –∑–∞—â–∏—Ç—É</li>
            </ul>
        </div>
    </div>
    
    <div class="code-area">
        <h1>‚öôÔ∏è –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã</h1>
        
        <div class="sequence-info">
            <strong>–¢–µ–∫—É—â–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong>
        </div>
        
        <div class="sequence" id="sequenceDisplay">
            <strong>–ó–∞–≥—Ä—É–∑–∫–∞...</strong>
        </div>

        <div class="draggables-panel">
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã:</h3>
            <div>
                <span class="draggable" draggable="true" data-value="100">[100]</span>
                <span class="draggable" draggable="true" data-value="01">[01]</span>
                <span class="draggable" draggable="true" data-value="1100">[1100]</span>
            </div>
            <div style="margin-top: 10px;">
                <button onclick="clearAllRules()">üßπ –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞</button>
            </div>
        </div>
        
        <div class="current-rules">
            <h3>–¢–µ–∫—É—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞:</h3>
            
            <div class="delete-zone" id="deleteZone">
                üóëÔ∏è –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç —Å—é–¥–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
            </div>
            
            <div id="currentRules"></div>
        </div>
    </div>

    <script>
        let botSequence = "";
        let sequenceIndex = 0;
        let winStreak = 0;
        
        // –í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (3 –∏–≥—Ä–æ–∫–∞ √ó 3 –±–æ—Ç–∞ = 9 –ø—Ä–∞–≤–∏–ª)
        const allPossibleRules = [
            '100-100', '100-01', '100-1100',
            '01-100', '01-01', '01-1100', 
            '1100-100', '1100-01', '1100-1100'
        ];
        
        // –ö–æ–¥—ã –∏ –∏—Ö –¥–ª–∏–Ω—ã
        const codes = [
            { value: '100', length: 3 },
            { value: '01', length: 2 },
            { value: '1100', length: 4 }
        ];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É –∏–≥—Ä—ã —Å–æ –≤—Å–µ–º–∏ 9 –ø—Ä–∞–≤–∏–ª–∞–º–∏
        let gameLogic = {};
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function generateRandomSequence(length = 10) {
            let sequence = "";
            let totalSymbols = 0;
            
            while (totalSymbols < length) {
                // –°–ª—É—á–∞–π–Ω–æ –≤—ã–±–∏—Ä–∞–µ–º –∫–æ–¥
                const randomCode = codes[Math.floor(Math.random() * codes.length)];
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø—Ä–µ–≤—ã—Å–∏–º –ª–∏ –º—ã –ª–∏–º–∏—Ç —Å–∏–º–≤–æ–ª–æ–≤
                if (totalSymbols + 1 <= length) {
                    sequence += randomCode.value;
                    totalSymbols++;
                } else {
                    break;
                }
            }
            
            return sequence;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
        function displaySequence(sequence) {
            const sequenceDisplay = document.getElementById('sequenceDisplay');
            let highlightedSequence = "";
            let i = 0;
            
            while (i < sequence.length) {
                let found = false;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∫–æ–¥—ã
                for (const code of codes) {
                    if (sequence.startsWith(code.value, i)) {
                        highlightedSequence += `<span style="color: #58a6ff; font-weight: bold;">${code.value}</span>`;
                        i += code.value.length;
                        found = true;
                        break;
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –∫–æ–¥, –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º —Å–∏–º–≤–æ–ª
                if (!found) {
                    highlightedSequence += sequence[i];
                    i++;
                }
            }
            
            sequenceDisplay.innerHTML = `<strong>${highlightedSequence}</strong>`;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function generateNewSequence() {
            botSequence = generateRandomSequence(10);
            sequenceIndex = 0;
            displaySequence(botSequence);
        }
        
        function initializeRules() {
            allPossibleRules.forEach(rule => {
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
                if (rule === '100-1100') gameLogic[rule] = {player: '100', bot: '1100', result: 'win'};
                else if (rule === '100-01') gameLogic[rule] = {player: '100', bot: '01', result: 'lose'};
                else if (rule === '01-100') gameLogic[rule] = {player: '01', bot: '100', result: 'win'};
                else if (rule === '01-1100') gameLogic[rule] = {player: '01', bot: '1100', result: 'lose'};
                else if (rule === '1100-01') gameLogic[rule] = {player: '1100', bot: '01', result: 'win'};
                else if (rule === '1100-100') gameLogic[rule] = {player: '1100', bot: '100', result: 'lose'};
                else gameLogic[rule] = {player: rule.split('-')[0], bot: rule.split('-')[1], result: 'draw'};
            });
        }

        function updateCurrentRules() {
            const rulesDiv = document.getElementById('currentRules');
            rulesDiv.innerHTML = '';
            
            // –í—Å–µ–≥–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ 9 –ø—Ä–∞–≤–∏–ª
            allPossibleRules.forEach(key => {
                const rule = gameLogic[key];
                const ruleDiv = document.createElement('div');
                ruleDiv.className = 'rule-item';
                
                ruleDiv.innerHTML = `
                    –ï—Å–ª–∏ –∏–≥—Ä–æ–∫ == <span class="slot" data-rule="${key}" data-type="player">
                        ${rule.player ? `<span class="slot-content" draggable="true">[${rule.player}]</span>` : '<span class="empty-slot">‚àÖ</span>'}
                    </span> 
                    –∏ –±–æ—Ç == <span class="slot" data-rule="${key}" data-type="bot">
                        ${rule.bot ? `<span class="slot-content" draggable="true">[${rule.bot}]</span>` : '<span class="empty-slot">‚àÖ</span>'}
                    </span>, —Ç–æ: 
                    <span class="result-slot ${rule.result}">${getResultText(rule.result)}</span>
                `;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å empty –µ—Å–ª–∏ —Å–ª–æ—Ç –ø—É—Å—Ç–æ–π
                const playerSlot = ruleDiv.querySelector('[data-type="player"]');
                const botSlot = ruleDiv.querySelector('[data-type="bot"]');
                if (!rule.player) playerSlot.classList.add('empty');
                if (!rule.bot) botSlot.classList.add('empty');
                
                rulesDiv.appendChild(ruleDiv);
            });
            
            setupDragAndDrop();
        }

        function setupDragAndDrop() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–ª–æ—Ç–æ–≤ —Å –∫–æ–¥–∞–º–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ)
            document.querySelectorAll('.slot').forEach(slot => {
                slot.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    slot.classList.add('hover');
                });
                
                slot.addEventListener('dragleave', () => {
                    slot.classList.remove('hover');
                });
                
                slot.addEventListener('drop', (e) => {
                    e.preventDefault();
                    slot.classList.remove('hover');
                    
                    const draggedValue = e.dataTransfer.getData('text/plain');
                    const ruleKey = slot.dataset.rule;
                    const slotType = slot.dataset.type;
                    
                    if (!ruleKey) return;
                    
                    // –†–∞–∑—Ä–µ—à–∞–µ–º –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–æ–¥—ã (100, 01, 1100)
                    if (!['100', '01', '1100'].includes(draggedValue)) return;
                    
                    const rule = gameLogic[ruleKey];
                    
                    if (slotType === 'player') {
                        rule.player = draggedValue;
                    } else if (slotType === 'bot') {
                        rule.bot = draggedValue;
                    }
                    
                    updateCurrentRules();
                });
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ —Å–ª–æ—Ç–æ–≤
            document.querySelectorAll('.slot-content').forEach(content => {
                content.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('text/plain', 'remove');
                    const slot = content.closest('.slot');
                    e.dataTransfer.setData('slot-type', slot.dataset.type);
                    e.dataTransfer.setData('rule-key', slot.dataset.rule);
                });
            });
            
            // –ó–æ–Ω–∞ —É–¥–∞–ª–µ–Ω–∏—è
            const deleteZone = document.getElementById('deleteZone');
            
            deleteZone.addEventListener('dragover', (e) => {
                e.preventDefault();
                deleteZone.classList.add('hover');
            });
            
            deleteZone.addEventListener('dragleave', () => {
                deleteZone.classList.remove('hover');
            });
            
            deleteZone.addEventListener('drop', (e) => {
                e.preventDefault();
                deleteZone.classList.remove('hover');
                
                const action = e.dataTransfer.getData('text/plain');
                if (action === 'remove') {
                    const slotType = e.dataTransfer.getData('slot-type');
                    const ruleKey = e.dataTransfer.getData('rule-key');
                    
                    if (ruleKey && slotType) {
                        const rule = gameLogic[ruleKey];
                        
                        if (slotType === 'player') {
                            rule.player = null; // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º —Å–ª–æ—Ç –∏–≥—Ä–æ–∫–∞
                        } else if (slotType === 'bot') {
                            rule.bot = null; // –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ–º —Å–ª–æ—Ç –±–æ—Ç–∞
                        }
                        
                        updateCurrentRules();
                    }
                }
            });
        }

        function clearAllRules() {
            if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞? –í—Å–µ —Å–ª–æ—Ç—ã —Å—Ç–∞–Ω—É—Ç –ø—É—Å—Ç—ã–º–∏.')) {
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (3 –ø–æ–±–µ–¥—ã, 3 –ø–æ—Ä–∞–∂–µ–Ω–∏—è, 3 –Ω–∏—á—å–∏)
                const winRules = [];
                const loseRules = [];
                const drawRules = [];
                
                // –°–æ–±–∏—Ä–∞–µ–º –ø—Ä–∞–≤–∏–ª–∞ –ø–æ –∏—Ö —Ç–µ–∫—É—â–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
                allPossibleRules.forEach(key => {
                    const rule = gameLogic[key];
                    if (rule.result === 'win') winRules.push(key);
                    else if (rule.result === 'lose') loseRules.push(key);
                    else drawRules.push(key);
                });
                
                // –û—á–∏—â–∞–µ–º –≤—Å–µ —Å–ª–æ—Ç—ã, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                allPossibleRules.forEach(key => {
                    gameLogic[key] = {player: null, bot: null, result: gameLogic[key].result};
                });
                
                updateCurrentRules();
            }
        }

        function getResultText(result) {
            return {
                'win': '–ü–æ–±–µ–¥–∏–ª –ò–≥—Ä–æ–∫',
                'lose': '–ü–æ–±–µ–¥–∏–ª –ë–æ—Ç',
                'draw': '–ù–∏—á—å—è'
            }[result];
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∞–ª—é—Ç–∞
        function createFirework(x, y) {
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            
            const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#ff00ff', '#00ffff', '#ffffff'];
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                
                const angle = Math.random() * Math.PI * 2;
                const distance = 50 + Math.random() * 100;
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;
                
                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                firework.appendChild(particle);
            }
            
            document.body.appendChild(firework);
            
            // –£–¥–∞–ª—è–µ–º —Å–∞–ª—é—Ç –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                firework.remove();
            }, 1500);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∞–ª—é—Ç–∞ –ø—Ä–∏ 5 –ø–æ–±–µ–¥–∞—Ö
        function celebrateWinStreak() {
            // –°–∞–ª—é—Ç —Å –ª–µ–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    createFirework(100, 100 + i * 150);
                }, i * 300);
            }
            
            // –°–∞–ª—é—Ç —Å –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
            for (let i = 0; i < 3; i++) {
                setTimeout(() => {
                    createFirework(window.innerWidth - 100, 100 + i * 150);
                }, i * 300 + 150);
            }
        }

        // Drag and Drop –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–æ–¥–∞
        document.querySelectorAll('.draggable').forEach(draggable => {
            draggable.addEventListener('dragstart', (e) => {
                e.dataTransfer.setData('text/plain', draggable.dataset.value);
            });
        });

        // –õ–æ–≥–∏–∫–∞ –∏–≥—Ä—ã
        document.querySelectorAll('.choice').forEach(choice => {
            choice.addEventListener('click', () => {
                document.querySelectorAll('.choice').forEach(c => c.classList.remove('selected'));
                choice.classList.add('selected');
            });
        });

        document.getElementById('playButton').addEventListener('click', () => {
            const selectedChoice = document.querySelector('.choice.selected');
            if (!selectedChoice) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç!');
                return;
            }

            const playerChoice = selectedChoice.dataset.value;
            
            // –ü–æ–ª—É—á–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–π —Ö–æ–¥ –±–æ—Ç–∞ –∏–∑ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            let botChoice = '';
            let i = sequenceIndex;
            while (i < botSequence.length) {
                if (botSequence.startsWith('100', i)) {
                    botChoice = '100';
                    break;
                } else if (botSequence.startsWith('01', i)) {
                    botChoice = '01';
                    break;
                } else if (botSequence.startsWith('1100', i)) {
                    botChoice = '1100';
                    break;
                }
                i++;
            }
            
            sequenceIndex = i + botChoice.length;
            
            // –ï—Å–ª–∏ –¥–æ—à–ª–∏ –¥–æ –∫–æ–Ω—Ü–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–∞—á–∏–Ω–∞–µ–º —Å–Ω–∞—á–∞–ª–∞
            if (sequenceIndex >= botSequence.length) {
                sequenceIndex = 0;
            }

            // –ò—â–µ–º –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ
            let result = 'draw'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∏—á—å—è
            
            // –ò—â–µ–º –ø—Ä–∞–≤–∏–ª–æ, –≥–¥–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç –∏ –∏–≥—Ä–æ–∫, –∏ –±–æ—Ç (–Ω–µ –ø—É—Å—Ç—ã–µ)
            for (const [key, rule] of Object.entries(gameLogic)) {
                const playerMatch = rule.player === playerChoice;
                const botMatch = rule.bot === botChoice;
                
                if (playerMatch && botMatch) {
                    result = rule.result;
                    break;
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫ –ø–æ–±–µ–¥
            if (result === 'win') {
                winStreak++;
            } else {
                winStreak = 0; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–∏ –Ω–∏—á—å–µ–π –∏–ª–∏ –ø—Ä–æ–∏–≥—Ä—ã—à–µ
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞
            document.getElementById('winStreak').textContent = winStreak;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ 5 –ø–æ–±–µ–¥ –ø–æ–¥—Ä—è–¥
            if (winStreak === 5) {
                celebrateWinStreak();
            }
            
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `
                <strong>–í—ã:</strong> ${getChoiceName(playerChoice)} <br>
                <strong>–ë–æ—Ç:</strong> ${getChoiceName(botChoice)} <br><br>
                <span class="${result}">${getResultText(result).toUpperCase()}</span>
                ${winStreak >= 3 ? `<br><small>–°–µ—Ä–∏—è –ø–æ–±–µ–¥: ${winStreak}</small>` : ''}
            `;
        });

        function getChoiceName(code) {
            return {
                '100': '–í–∑–ª–æ–º—â–∏–∫ üïµÔ∏è',
                '01': '–ó–∞—â–∏—Ç–∞ üõ°Ô∏è',
                '1100': '–£—è–∑–≤–∏–º–æ—Å—Ç—å üíä'
            }[code];
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        initializeRules();
        generateNewSequence(); // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
        updateCurrentRules();
    </script>
</body>
</html>